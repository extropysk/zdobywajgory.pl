(this.webpackJsonpkd=this.webpackJsonpkd||[]).push([[9],{519:function(e,t,n){"use strict";n(2);var a=n(170),i=n.n(a),r=n(521),s=n.n(r),l=n(7),c=n(0);t.a=Object(l.withStyles)((function(e){return{formControl:{margin:e.spacing.unit,width:160}}}))((function(e){return Object(c.jsxs)(i.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0,children:[Object(c.jsx)(s.a,{id:"simple-dialog-title",children:e.title}),e.children]})}))},523:function(e,t,n){"use strict";var a=n(3),i=n.n(a),r=n(6),s=n(18),l=n(19),c=n(21),o=n(20),u=n(4),d=n(2),h=n.n(d),p=n(7),m=n(169),g=n(528),f=n.n(g),b=n(69),j=n.n(b),x=n(64),O=n.n(x),C=n(527),v=n.n(C),w=n(0);var k=Object(p.withStyles)((function(e){return{}}))((function(e){var t=e.color,n=e.onClick,a=e.tooltip,i=e.disabled,r=e.className;return Object(w.jsx)(v.a,{title:a,children:Object(w.jsx)(O.a,{color:t,onClick:n,"aria-label":a,disabled:i,className:r,children:e.children})})})),y=n(93),S=n(11),_=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).onChange=function(){var e=Object(r.a)(i.a.mark((function e(t){var n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target.files[0],a.filePath=URL.createObjectURL(n),t.target.value="","image/jpeg"!==a.props.mimeType){e.next=10;break}return r=window.URL||window.webkitURL,s=r.createObjectURL(n),e.next=9,a.props.utils.resize(s,a.props.height,n.name);case 9:n=e.sent;case 10:a.props.onChange(a.props.field,n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onClick=function(){a.props.disabled||a.inputRef.current.click()},a.inputRef=h.a.createRef(),a.filePath="",a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.value,a=e.disabled,i=e.mimeType,r=e.field,s=e.translate,l=this.props.label||s("field."+r);return Object(w.jsxs)("div",{children:[Object(w.jsx)(k,{className:t.button,tooltip:Object(w.jsx)("img",{src:null!==n&&""===this.filePath?n:this.filePath,alt:"Attach file",className:t.tooltip}),color:n?"primary":"default",onClick:this.onClick,disabled:a,children:Object(w.jsx)(f.a,{})}),Object(w.jsx)(j.a,{htmlFor:r,children:l}),Object(w.jsx)("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:i,onChange:this.onChange})]})}}]),n}(h.a.Component);t.a=Object(S.b)(Object(y.a)(Object(p.withStyles)((function(e){return Object(u.a)(Object(u.a)({},Object(m.a)(e)),{},{button:{margin:e.spacing.unit},tooltip:{"max-width":"150px","max-height":"150px"}})}))(_)))},529:function(e,t,n){"use strict";var a=n(14),i=n(3),r=n.n(i),s=n(4),l=n(532),c=n(536),o=n(2),u=n.n(o),d=n(525),h=n.n(d),p=n(172),m=n(7),g=n(144),f=n.n(g),b=n(64),j=n.n(b),x=n(169),O=n(93),C=(n(533),n(6)),v=n(534),w=n.n(v),k=n(535),y=n.n(k),S=n(0),_=function(e,t,n,a,i){return{name:"Custom command",icon:function(){return Object(S.jsx)("img",{src:t,alt:"Custom command",className:e,onClick:function(e){return n(e,i)}})},execute:function(e){a(e)}}},D=function(e){var t=u.a.createRef(),n=null,a=function(){var t=Object(C.a)(r.a.mark((function t(a){var i,s,l,c,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),i=a.target.files[0],a.target.value="",s=window.URL||window.webkitURL,l=s.createObjectURL(i),t.next=7,e.utils.resize(l,e.height,"img.jpg");case 7:return c=t.sent,t.prev=8,t.next=11,e.postFile(c);case 11:o=t.sent,n.textApi.replaceSelection('<img src="{URL}/api/file/'.concat(o._id,'" alt="img" style="max-height:480px;" />')),t.next=19;break;case 15:return t.prev=15,t.t0=t.catch(8),console.log(t.t0),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t,null,[[8,15]])})));return function(e){return t.apply(this,arguments)}}();return{name:"Custom command",icon:function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(w.a,{}),Object(S.jsx)("input",{ref:t,style:{display:"none"},type:"file",accept:"image/jpeg",onChange:a})]})},execute:function(e){!function(e){t.current.click(),n=e}(e)}}};var R=function(e,t,n){var a=e.classes;return{commands:{Emojis:_(a.emojiSize,"/img/emojis/nerd.png",t,n,"Emojis"),Marks:_(a.markSize,"/img/marks/mark black.png",t,n,"Marks"),UploadFile:D(e),Center:{name:"Custom command",icon:function(){return Object(S.jsx)(y.a,{})},execute:function(e){e.textApi.replaceSelection('<div class="center"></div>')}}},toolbarCommands:["Emojis","Marks","UploadFile","Center"]}},F=null,N="",T=["Asset 4.svg","camera.png","compas.svg","fist.png","hi.png","medal.png","metal.png","nerd.png","rocks.svg","sadman.png","crossroad.svg","mountain.png","rocks.svg","nerd.png","tree.png","triangel.svg","triangle.png"],U=["mark black.png","mark blue.png","mark brown.png","mark green.png","mark red.png","mark yellow.png"],I=function(e){F=e},E=function(){var e={data:[]},t=""!==N?"Emojis"===N?{path:"/img/emojis/",data:T,className:"emoji"}:"Marks"===N?{path:"/img/marks/",data:U,className:"emoji"}:e:e;return t.data.map((function(e){return Object(S.jsx)(j.a,{onClick:function(n){F&&F.textApi.replaceSelection('<img src="'.concat(t.path+e,'" alt="Custom command" className="').concat(t.className,'" />'))},style:{backgroundColor:"transparent"},children:Object(S.jsx)("img",{src:t.path+e,alt:"Custom command",className:t.className})})}))};t.a=Object(m.withStyles)((function(e){return Object(s.a)(Object(s.a)({},Object(x.a)(e)),{},{typography:{padding:e.spacing.unit/2},markSize:{width:"30px",height:"20px"},emojiSize:{width:"20px",height:"20px"},tooltip:{"max-width":"150px","max-height":"150px"}})}))(Object(O.a)((function(e){var t=function(){var t=Object(c.a)(r.a.mark((function t(n){var a,i,s,c,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Blob([n],{type:"image/jpeg"}),i=window.URL||window.webkitURL,s=i.createObjectURL(a),t.next=5,Object(l.a)(e.utils.resize(s,e.height,"img.jpg"));case 5:return c=t.sent,t.prev=6,t.next=9,Object(l.a)(e.postFile(c));case 9:return o=t.sent,t.next=12,"{URL}/api/file/".concat(o._id);case 12:return t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(6),console.log(t.t0),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t,null,[[6,15]])})));return function(e){return t.apply(this,arguments)}}(),n=u.a.useState("write"),i=Object(a.a)(n,2),s=i[0],o=i[1],m=u.a.useState(null),g=Object(a.a)(m,2),b=g[0],j=g[1],x=Boolean(b),O=x?"simple-popover":void 0,C=R(e,(function(e,t){j(e.currentTarget),N=t}),I),v=Object(d.getDefaultToolbarCommands)();return v.push(C.toolbarCommands),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(h.a,{commands:C.commands,toolbarCommands:v,value:e.value,onChange:function(t){return e.onChange(e.field,t)},selectedTab:s,readOnly:e.disabled,onTabChange:o,generateMarkdownPreview:function(e){return Promise.resolve(Object(S.jsx)(p.a,{children:e}))},paste:e.postFile?{saveImage:t}:null}),Object(S.jsx)(f.a,{id:O,open:x,anchorEl:b,onClose:function(){j(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:E()})]})})))},537:function(e,t,n){"use strict";var a=n(3),i=n.n(a),r=n(6),s=n(18),l=n(19),c=n(21),o=n(20),u=n(4),d=n(2),h=n.n(d),p=n(7),m=n(520),g=n(171),f=n(112),b=n(540),j=n(523),x=n(524),O=n(169),C=n(9),v=n(5),w=n.n(v),k=n(529),y=n(1),S=n.n(y),_=n(16),D=n(26),R=n(29),F=n(8),N=n(0),T={name:"",description:"",summitsRef:[],packsRef:[],serieRef:null,difficulty:1,start:new Date,end:new Date,regStart:new Date,regEnd:new Date,key:0,_img:null,_imgDesktop:null,_thumbnail:null,_map:null,_logo:null,_badge:null,_mapDark:null,_mapFull:null,_mapFullTransparent:null,_logoDark:null,_medalFront:null,_medalBack:null},U=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChangeFile=function(e,t){a.setState({[e]:t,[e+"Changed"]:!0})},a.handleChange=function(e,t){a.setState({[e]:t})},a.handleChangeSummitsRef=function(e,t){var n=t.map((function(e){return{id:e}}));a.setState({[e]:n})},a.handleChangePacksRef=function(e,t){var n=t.map((function(e){return{id:e}}));a.setState({[e]:n})},a.handleChangeSerieRef=function(e,t){a.setState({[e]:{id:t}})},a.handleSubmit=Object(r.a)(i.a.mark((function e(){var t,n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.doby,n=t.addChallenge,r=t.refreshChallenges,s=t.editChallenge,e.prev=1,!a.state._id){e.next=7;break}return e.next=5,s(a.state);case 5:e.next=9;break;case 7:return e.next=9,n(a.state);case 9:r(),a.setState(T),a.props.onSubmit&&a.props.onSubmit(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),a.props.user.showError(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])}))),a.state=e.data||T,a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(i.a.mark((function e(){var t,n,a,r,s,l,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props.doby,n=t.getSummits,a=t.getSeries,r=t.getFilesChallenge,s=t.getProducts,e.next=4,n();case 4:return e.next=6,a();case 6:return l=[{field:"catalog_id",op:"eq",value:"pack"}],e.next=9,s(l);case 9:if(!this.state._id){e.next=14;break}return e.next=12,r(this.state,!0);case 12:c=e.sent,this.setState((function(e){return Object(u.a)({},c)}));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.disabled,a=this.state,i=a.name,r=a.description,s=a.start,l=a.end,c=a.regEnd,o=a.regStart,u=a.summitsRef,d=a.packsRef,h=a.serieRef,p=a.difficulty,O=a.key,v=a._img,y=a._imgDesktop,_=a._map,D=a._thumbnail,R=a._logo,F=a._badge,T=a._mapDark,U=a._mapFull,I=a._logoDark,E=a._mapFullTransparent,L=a._medalFront,q=a._medalBack,z=this.props.doby,B=z.summits,W=z.series,M=z.products;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(f.a,{onSubmit:this.handleSubmit,inline:!0,disabled:n,children:[Object(N.jsxs)(w.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:[Object(N.jsx)(w.a,{item:!0,xs:6,className:S()(t.pr10),children:Object(N.jsx)(m.a,{value:i,field:"name",onChange:this.handleChange,required:!0,disabled:n,fullWidth:!0})}),Object(N.jsx)(w.a,{item:!0,xs:3,className:S()(t.pr10),children:Object(N.jsx)(b.a,{value:s,field:"start",onChange:this.handleChange,required:!0})}),Object(N.jsx)(w.a,{item:!0,xs:3,className:S()(t.pr10),children:Object(N.jsx)(b.a,{value:l,field:"end",onChange:this.handleChange,required:!0})})]}),Object(N.jsxs)(w.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:[Object(N.jsx)(w.a,{item:!0,xs:2,className:S()(t.pr10),children:Object(N.jsx)(x.a,{value:O,field:"key",onChange:this.handleChange,min:0,step:1,fullWidth:!0})}),Object(N.jsx)(w.a,{item:!0,xs:2,className:S()(t.pr10),children:Object(N.jsx)(x.a,{value:p,field:"difficulty",onChange:this.handleChange,min:0,max:5,step:1,required:!0,fullWidth:!0})}),Object(N.jsx)(w.a,{item:!0,xs:4,className:S()(t.pr10,t.pl10),children:Object(N.jsx)(g.a,{value:h?h.id:null,field:"serieRef",onChange:this.handleChangeSerieRef,data:W.data,textField:"name",required:!0,idField:"id",disabled:n,fullWidth:!0})}),Object(N.jsx)(w.a,{item:!0,xs:4,className:S()(t.pr10),children:Object(N.jsx)(g.a,{value:u?u.map((function(e){return e.id})):[],field:"summitsRef",onChange:this.handleChangeSummitsRef,fullWidth:!0,data:B.data,textField:"name",required:!0,multiple:!0,idField:"id",disabled:n})})]}),Object(N.jsxs)(w.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:[Object(N.jsx)(w.a,{item:!0,xs:6,className:S()(t.pr10,t.pl10),children:Object(N.jsx)(g.a,{value:d?d.map((function(e){return e.id})):[],field:"packsRef",onChange:this.handleChangePacksRef,fullWidth:!0,data:M.data,textField:"name",required:!0,multiple:!0,idField:"id",disabled:n})}),Object(N.jsx)(w.a,{item:!0,xs:3,className:S()(t.pr10),children:Object(N.jsx)(b.a,{value:o,field:"regStart",onChange:this.handleChange})}),Object(N.jsx)(w.a,{item:!0,xs:3,className:S()(t.pr10),children:Object(N.jsx)(b.a,{value:c,field:"regEnd",onChange:this.handleChange})})]}),Object(N.jsx)(j.a,{mimeType:"image/jpeg",value:v,field:"_img",onChange:this.handleChangeFile,disabled:n,height:C.a.imageSize}),Object(N.jsx)(j.a,{mimeType:"image/jpeg",value:y,field:"_imgDesktop",onChange:this.handleChangeFile,disabled:n,height:C.a.imageSize}),Object(N.jsx)(j.a,{mimeType:"image/jpeg",value:D,field:"_thumbnail",onChange:this.handleChangeFile,disabled:n,height:C.a.thumbnailSize}),Object(N.jsx)(j.a,{mimeType:"image/png",value:R,field:"_logo",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/png",value:_,field:"_map",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/png",value:F,field:"_badge",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/png",value:I,field:"_logoDark",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/png",value:T,field:"_mapDark",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/jpeg",value:U,field:"_mapFull",onChange:this.handleChangeFile,disabled:n,height:C.a.imageSize}),Object(N.jsx)(j.a,{mimeType:"image/png",value:E,field:"_mapFullTransparent",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/png",value:L,field:"_medalFront",onChange:this.handleChangeFile,disabled:n}),Object(N.jsx)(j.a,{mimeType:"image/png",value:q,field:"_medalBack",onChange:this.handleChangeFile,disabled:n})]}),Object(N.jsx)(k.a,{field:"description",value:r,onChange:this.handleChange,height:C.a.imageSize,disabled:n,postFile:this.props.store.postFile})]})}}]),n}(h.a.Component);t.a=Object(F.a)(Object(p.withStyles)((function(e){return Object(u.a)(Object(u.a)({},Object(O.a)(e)),{},{nameTextInput:{display:"flex",flex:1},mr10:{"margin-right":"10px"},ml10:{"margin-left":"10px"},pr10:{"padding-right":"10px"},pl10:{"padding-left":"10px"}})})),_.a,D.a,R.a)(U)},623:function(e,t,n){"use strict";n.r(t);var a=n(4),i=n(2),r=n.n(i),s=n(7),l=n(5),c=n.n(l),o=n(3),u=n.n(o),d=n(27),h=n(6),p=n(18),m=n(19),g=n(21),f=n(20),b=n(77),j=n.n(b),x=n(522),O=n(519),C=n(559),v=n(520),w=n(171),k=n(112),y=n(11),S=n(124),_=n(1),D=n.n(_),R=n(16),F=n(29),N=n(26),T=n(8),U=n(0),I={username:"",email:"",tel:"",address:"",postCode:"",city:"",countryId:"",challenges:[{name:"a"},{name:"b"}]},E=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).getCountries=Object(h.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.store.getEnums,n=[{field:"enumTypeId",value:5},{field:"disabled",value:!1}],e.next=4,t(n);case 4:case"end":return e.stop()}}),e)}))),a.getChallenges=Object(h.a)(u.a.mark((function e(){var t,n,i,r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state._id){e.next=13;break}return t=a.props,n=t.doby,i=t.user,e.prev=2,e.next=5,n.getUser(a.state._id,!0);case 5:r=e.sent,s=r?r.challenges:[],a.setState((function(){return{challenges:s,dobyUser:r}})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),i.showError(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])}))),a.renderChallenges=function(){var e=a.props,t=e.classes,n=e.translate;return a.state.challenges?Object(U.jsxs)(c.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:[Object(U.jsx)(c.a,{item:!0,xs:12,className:D()(t.p10,t.title),children:Object(U.jsx)("span",{children:n("challenges_title")})}),Object(U.jsx)(c.a,{item:!0,xs:12,className:D()(t.p10),children:a.state.challenges.map((function(e){return e.name})).join(", ")})]}):Object(U.jsx)(U.Fragment,{})},a.handleChangeCountry=function(e,t){var n=a.props.store.enums.data.find((function(e){return e._id===t}));a.setState({[e]:n?n.key:0})},a.handleChange=function(e,t){a.setState({[e]:t})},a.handleSubmit=Object(h.a)(u.a.mark((function e(){var t,n,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.user,n=t.refreshUsers,i=t.updateUser,e.prev=1,e.next=4,i(a.state._id,a.state,!1);case 4:n(),a.props.onSubmit&&a.props.onSubmit(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.user.showError(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a.state=e.data||I,a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCountries();case 2:return e.next=4,this.getChallenges();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.disabled,a=this.props.store.enums,i=this.state,r=i.username,s=i.email,l=i.tel,o=i.address,u=i.postCode,d=i.city,h=i.countryId,p=a.data.find((function(e){return e.key===h}));return Object(U.jsxs)(k.a,{onSubmit:this.handleSubmit,inline:!0,disabled:n,children:[Object(U.jsx)(c.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:Object(U.jsx)(c.a,{item:!0,xs:12,className:D()(t.nameTextInput),children:Object(U.jsx)(v.a,{value:r,field:"username",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:n})})}),Object(U.jsx)(c.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:Object(U.jsx)(c.a,{item:!0,xs:12,className:D()(t.nameTextInput),children:Object(U.jsx)(v.a,{value:s,field:"email",type:"email",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:n})})}),Object(U.jsx)(c.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:Object(U.jsx)(c.a,{item:!0,xs:12,className:D()(t.nameTextInput),children:Object(U.jsx)(v.a,{value:o,field:"address",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:n})})}),Object(U.jsxs)(c.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:[Object(U.jsx)(c.a,{item:!0,xs:8,className:D()(t.pr10,t.nameTextInput),children:Object(U.jsx)(v.a,{value:d,field:"city",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:n})}),Object(U.jsx)(c.a,{item:!0,xs:4,className:D()(t.pr10,t.nameTextInput),children:Object(U.jsx)(v.a,{value:u,field:"postCode",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:n})})]}),Object(U.jsxs)(c.a,{container:!0,direction:"row",justify:"left",alignItems:"left",children:[Object(U.jsx)(c.a,{item:!0,xs:6,className:D()(t.pr10,t.pl10,t.nameTextInput),children:Object(U.jsx)(w.a,{onChange:this.handleChangeCountry,fullWidth:!0,data:a.data,value:p?p._id:"",field:"countryId",textField:"name",required:!0,disabled:n})}),Object(U.jsx)(c.a,{item:!0,xs:6,className:D()(t.p10,t.nameTextInput),children:Object(U.jsx)(S.a,{fullWidth:!0,value:l,field:"tel",onChange:this.handleChange,disabled:n})})]}),this.renderChallenges()]})}}]),n}(r.a.Component),L=Object(T.a)(Object(s.withStyles)((function(e){return{nameTextInput:{display:"flex",flex:1},pr10:{"padding-right":"10px"},pl10:{"padding-left":"10px"},p10:{padding:"10px"},title:{"font-weight":"bold"}}})),R.a,F.a,y.b,N.a)(E),q=n(537),z=n(46),B=n(169),W=n(30),M=n.n(W),P=n(9),A=[],J=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).generateRows=function(){return[{field:"name",disablePadding:!0},{field:"email"},{field:"tel"},{field:"challengesRef",cell:a.handleChallengesBtn,filterable:!1},{field:"_id"}]},a.handleChallengesBtn=function(e){return Object(U.jsx)(j.a,{variant:"contained",color:"primary",onClick:function(){return a.handleOnClickChallengesBtn(e)},children:a.props.translate("show")})},a.handleOnClickChallengesBtn=function(){var e=Object(h.a)(u.a.mark((function e(t){var n,i,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState((function(){return{isLoading:!0}})),e.next=4,a.props.doby.getUser(t._id);case 4:i=e.sent,(i=null!==(n=i)&&void 0!==n?n:null)&&(r=i.challenges.map((function(e){return e._id})),A=Object(d.a)(r)),a.setState((function(e){return{isChallengesDialogOpen:!0,isLoading:!1,dobyUser:i,x:t}})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),a.props.user.showError(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),a.handleDelete=function(){var e=Object(h.a)(u.a.mark((function e(t){var n,i,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.user,i=n.deleteUser,r=n.showError,e.prev=1,e.next=4,i(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),r(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),a.handleChangeClient=function(e,t){a.setState({clientId:t})},a.handleClose=function(){a.setState({isOpen:!1})},a.handleOpen=function(){a.setState({isOpen:!0})},a.handleChange=function(){var e=Object(h.a)(u.a.mark((function e(t,n,i,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.user.getUsers(t,i,n,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n,a,i){return e.apply(this,arguments)}}(),a.onEdit=function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({x:t,isOpen:!0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.generateChallengesRows=function(){return[{field:"_id",disablePadding:!0},{field:"name"},{field:"button",cell:a.handleAddRemoveBtn,filterable:!1}]},a.handleAddRemoveBtn=function(e){var t=a.props,n=t.classes,i=t.translate,r=A.includes(e._id);return Object(U.jsx)(j.a,{className:n.addRemoveBtn,variant:"contained",color:r?"inherit":"primary",onClick:function(){return r?a.handleChallengeDelete(e._id):a.handleChallengeAdd(e)},children:i(r?"take":"assign")})},a.handleChallengesDialogClose=function(){a.setState({isChallengesDialogOpen:!1})},a.onEditChallenge=function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState((function(e){return{challenge:t,isChallengeDialogOpen:!0}}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChallengeAdd=function(){var e=Object(h.a)(u.a.mark((function e(t){var n,i,r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.doby,i=n.addUserChallenge,r=n.refreshChallenges,e.prev=1,e.next=4,i(a.state.x._id,t._id);case 4:return s=e.sent,A=Object(d.a)(s.challengesRef.map((function(e){return e.id}))),e.next=8,a.handleSendNotification(t);case 8:r(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.props.user.showError(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),a.handleChallengeDelete=function(){var e=Object(h.a)(u.a.mark((function e(t){var n,i,r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.doby,i=n.deleteUserChallenge,r=n.refreshChallenges,e.prev=1,e.next=4,i(a.state.x._id,t);case 4:s=e.sent,A=Object(d.a)(s.challengesRef.map((function(e){return e.id}))),r(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a.props.user.showError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),a.handleChallengeChange=function(){var e=Object(h.a)(u.a.mark((function e(t,n,i,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.props.doby.getChallenges(t,i,n,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),a.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n,a,i){return e.apply(this,arguments)}}(),a.handleChallengeDialogClose=function(){a.setState({isChallengeDialogOpen:!1})},a.isDisabledChallenge=function(e){return!0},a.handleSendNotification=function(){var e=Object(h.a)(u.a.mark((function e(t){var n,i,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.dobyUser,i=!1,n&&(r=n.meta,i=r&&r.disableNotifications&&"1"===r.disableNotifications),i||a.sendMail(a.state.x._id,t,"");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.sendMail=function(){var e=Object(h.a)(u.a.mark((function e(t,n,i){var r,s,l,c,o,d,h,p,m,g,f,b,j,x,O,C;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.props,s=r.translate,l=r.mail,c=r.doby,o=null,e.prev=2,!n){e.next=7;break}return e.next=6,c.getChallenge(n._id);case 6:o=e.sent;case 7:o&&(h=(d=o)._id,p=d.summits,m=d.end,g=d.start,f=d.difficulty,b=d.name,j=d.logoId,x=a.handleDates(g,m),O=s("email_challenge_bought_subject"),C={subject:O.replace("{0}",b),from:P.a.mail.address,fromName:P.a.mail.name,recipientRef:{id:t},ru:"/challenge-detail/"+h,templateId:P.a.mail.challengeBoughtTemplate,params:["".concat(x.months," ").concat(1===x.months?s("challenge.month"):x.months<5?s("challenge.months"):s("challenge.month_gen")),p.length,x.start,x.end,f,p.map((function(e){return e.name})).join(","),b,"".concat(P.a.url.doby,"/api/file/").concat(j||""),i]},l.sendMail(C)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),a.props.user.showError(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,a){return e.apply(this,arguments)}}(),a.handleDates=function(e,t){var n=M()(e).diff(M()(t),"months",!0);n=Math.abs(n),n=Math.ceil(n);var a=P.a.locale;return{start:new Date(e).toLocaleDateString(a).replace(/\s/g,""),end:new Date(t).toLocaleDateString(a).replace(/\s/g,""),months:n}},a.isDisabled=function(e){return!1},a.state={x:null,isOpen:!1,isLoading:!1,isChallengesDialogOpen:!1,isChallengeDialogOpen:!1,challenge:null,challenges:[],dobyUser:null},a}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.translate;return Object(U.jsxs)("div",{children:[Object(U.jsx)(x.a,{rows:this.generateRows(),data:"users",onChange:this.handleChange,onDelete:this.handleDelete,title:e("users"),onEdit:this.onEdit,store:this.props.user,filters:[],isDisabled:this.isDisabled,filename:"users"}),Object(U.jsx)(O.a,{title:e("user"),onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(U.jsx)(L,{data:this.state.x,onSubmit:this.handleClose})}),Object(U.jsxs)(O.a,{title:e("challenges"),onClose:this.handleChallengesDialogClose,isOpen:this.state.isChallengesDialogOpen,children:[Object(U.jsx)(x.a,{rows:this.generateChallengesRows(),data:"challenges",onChange:this.handleChallengeChange,onDelete:this.handleChallengeDelete,title:e("challenges_title"),onEdit:this.onEditChallenge,store:Object(a.a)(Object(a.a)({},this.props.doby),this.props.store),filters:[],isDisabled:this.isDisabledChallenge}),Object(U.jsx)(O.a,{title:e("challenge_title"),onClose:this.handleChallengeDialogClose,isOpen:this.state.isChallengeDialogOpen,children:Object(U.jsx)(q.a,{data:this.state.challenge,onSubmit:this.handleChallengeDialogClose})})]}),Object(U.jsx)(C.a,{isLoading:this.state.isLoading})]})}}]),n}(r.a.Component),G=Object(T.a)(z.a,N.a,F.a,R.a,y.b,Object(s.withStyles)((function(e){return Object(a.a)(Object(a.a)({},Object(B.a)(e)),{},{addRemoveBtn:{float:"right"}})})))(J),H=n(10);t.default=Object(T.a)(Object(s.withStyles)((function(e){return Object(a.a)(Object(a.a)({},Object(H.a)(e)),{},{paper:{padding:e.spacing.unit}})})),N.a)((function(e){var t=e.classes;return Object(U.jsx)(c.a,{container:!0,children:Object(U.jsx)(c.a,{item:!0,xs:12,className:t.p2,children:Object(U.jsx)(G,{})})})}))}}]);